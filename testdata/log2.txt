{"severity":"info","timestamp":"2022-06-06 19:54:23.826","message":"Starting...","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"component":"main"}
{"severity":"info","timestamp":"2022-06-06 19:54:23.827","message":"{\"ops\":{\"loglevel\":\"debug\",\"verbose_log_enabled\":true,\"stackprofiler_enabled\":false,\"projectid\":\"\",\"opencensus\":{\"servicename\":\"ob-authorisation-service\"}},\"appname\":\"authorisation-service\",\"hostname\":\"localhost\",\"port\":3333,\"environment\":\"local\",\"version\":\"NOT_SET\",\"commit\":\"NOT_SET\",\"timestamp\":\"NOT_SET\",\"jwtauth\":{\"issuers\":[{\"name\":\"mountebank-sti\",\"jwksUrl\":\"http://localhost:4588/mountebank-sti/.well-known/jwks.json\",\"cacheTTL\":\"24h0m0s\",\"cacheRefresh\":\"15m0s\"}],\"headers\":[\"Authorization\"]},\"postgres\":{\"host\":\"localhost\",\"port\":5433,\"dbname\":\"authdb\",\"user\":\"auth\",\"password\":\"XXXXX\",\"tls\":{\"mode\":\"disable\"},\"maxconn\":25,\"maxidle\":3,\"maxlifetime\":\"30m0s\"},\"pes\":{\"broker\":\"broker:9092\",\"registry\":\"http://localhost:8081\",\"frombeginning\":false,\"tls\":{\"mode\":\"disable\",\"calocation\":\"\"},\"debug\":\"\",\"authtopicv2\":\"au.pes.notenriched.ObAuthorisationLifecycleEvent-v2\",\"authojahtopicv2\":\"au.pes.notenriched.ObAuthorisationLifecycleOtherPartyEvent-v2\",\"retractiontopicv2\":\"au.pes.notenriched.ObAccountRetractionEvent-v2\",\"retractionojahtopicv2\":\"au.pes.notenriched.ObAccountRetractionOtherPartyEvent-v2\",\"nestopicv3\":\"au.pes.notenriched.ObCustomerNotificationEvent-v3\",\"max_retry\":5,\"min_back_off_time\":\"300ms\"},\"redis\":{\"address\":\"localhost:6379\",\"expiry\":\"3m0s\",\"maxIdleConn\":100,\"maxActiveConn\":12000,\"maxconnlifetime\":\"30m0s\"},\"entitlements\":{\"url\":\"http://localhost:3687\"},\"eventing\":{\"url\":\"http://localhost:7000\"},\"uam\":{\"url\":\"http://localhost:8266\"},\"mle\":{\"url\":\"http://localhost:7353\"},\"rdr\":{\"url\":\"http://localhost:3939\"},\"lookup\":{\"url\":\"http://localhost:8002\"},\"nominationservice\":{\"url\":\"http://localhost:6286\"},\"ecomapikey\":\"\",\"nes\":{\"url\":\"http://localhost:6370\"},\"ocv\":{\"url\":\"http://localhost:6284\"},\"sali\":{\"url\":\"http://localhost:7254\"},\"eam\":{\"url\":\"http://localhost:2775\"},\"corpapikey\":\"XXXXX\",\"ocv_api_calls_per_batch\":3,\"forgerock\":{\"url\":\"http://localhost:8001\",\"clientid\":\"auth-stg3\",\"secret\":\"XXXXX\"},\"feature\":{}}","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"component":"main-config"}
{"severity":"info","timestamp":"2022-06-06 19:54:23.845","message":"rq-begin","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"logging.googleapis.com/trace":"","logging.googleapis.com/spanId":"","logging.googleapis.com/trace_sampled":false,"component":"httpclient","request":{"requestUrl":"http://localhost:4588/mountebank-sti/.well-known/jwks.json","curl":"curl -X 'GET' -H 'Cache-Control: no-cache' -H 'X-Anz-Application-Version: NOT_SET' -H 'X-Application-Context: ob-authorisation-service' -H 'X-Forwarded-For: 192.168.86.142' 'http://localhost:4588/mountebank-sti/.well-known/jwks.json'"}}
{"severity":"info","timestamp":"2022-06-06 19:54:23.870","message":"FAIL[thrd:broker:9092/bootstrap]: broker:9092/bootstrap: Failed to resolve 'broker:9092': nodename nor servname provided, or not known (after 27ms in state CONNECT)","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"component":"pes-producer-kafka"}
{"severity":"error","timestamp":"2022-06-06 19:54:23.870","message":"broker:9092/bootstrap: Failed to resolve 'broker:9092': nodename nor servname provided, or not known (after 27ms in state CONNECT)","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"component":"pesproducer","error":"broker:9092/bootstrap: Failed to resolve 'broker:9092': nodename nor servname provided, or not known (after 27ms in state CONNECT)","errorVerbose":"broker:9092/bootstrap: Failed to resolve 'broker:9092': nodename nor servname provided, or not known (after 27ms in state CONNECT)\ngithub.service.anz/ob/ob-services-library/pkg/log.(*Entry).WithError\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/ob/ob-services-library/pkg/log/logger.go:128\ngithub.service.anz/ob/authorisationservice/internal/pes.ErrorHandler\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/internal/pes/pes.go:81\ngithub.service.anz/go/kafka-avro-producer.(*Servicer).handleKafkaEvent\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/go/kafka-avro-producer/producer.go:179\ngithub.service.anz/go/kafka-avro-producer.NewService.func1\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/go/kafka-avro-producer/producer.go:105\nruntime.goexit\n\t/opt/homebrew/Cellar/go/1.18.2/libexec/src/runtime/asm_arm64.s:1263","stacktrace":"github.service.anz/ob/ob-services-library/pkg/log.(*Entry).Error\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/ob/ob-services-library/pkg/log/logger.go:146\ngithub.service.anz/ob/authorisationservice/internal/pes.ErrorHandler\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/internal/pes/pes.go:85\ngithub.service.anz/go/kafka-avro-producer.(*Servicer).handleKafkaEvent\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/go/kafka-avro-producer/producer.go:179\ngithub.service.anz/go/kafka-avro-producer.NewService.func1\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/go/kafka-avro-producer/producer.go:105"}
{"severity":"error","timestamp":"2022-06-06 19:54:23.870","message":"1/1 brokers are down","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"component":"pesproducer","error":"1/1 brokers are down","errorVerbose":"1/1 brokers are down\ngithub.service.anz/ob/ob-services-library/pkg/log.(*Entry).WithError\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/ob/ob-services-library/pkg/log/logger.go:128\ngithub.service.anz/ob/authorisationservice/internal/pes.ErrorHandler\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/internal/pes/pes.go:81\ngithub.service.anz/go/kafka-avro-producer.(*Servicer).handleKafkaEvent\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/go/kafka-avro-producer/producer.go:179\ngithub.service.anz/go/kafka-avro-producer.NewService.func1\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/go/kafka-avro-producer/producer.go:105\nruntime.goexit\n\t/opt/homebrew/Cellar/go/1.18.2/libexec/src/runtime/asm_arm64.s:1263","stacktrace":"github.service.anz/ob/ob-services-library/pkg/log.(*Entry).Error\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/ob/ob-services-library/pkg/log/logger.go:146\ngithub.service.anz/ob/authorisationservice/internal/pes.ErrorHandler\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/internal/pes/pes.go:85\ngithub.service.anz/go/kafka-avro-producer.(*Servicer).handleKafkaEvent\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/go/kafka-avro-producer/producer.go:179\ngithub.service.anz/go/kafka-avro-producer.NewService.func1\n\t/Users/calegara/go/src/github.service.anz/ob/authorisationservice/vendor/github.service.anz/go/kafka-avro-producer/producer.go:105"}
{"severity":"info","timestamp":"2022-06-06 19:54:24.031","message":"rq-end","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"logging.googleapis.com/trace":"","logging.googleapis.com/spanId":"","logging.googleapis.com/trace_sampled":false,"component":"httpclient","response":{"requestUrl":"http://localhost:4588/mountebank-sti/.well-known/jwks.json","status":200,"responseHeader":{"Content-Type":"application/json","Date":"Mon, 06 Jun 2022 09:54:24 GMT"},"responseBody":"{\"keys\":[{\"kty\":\"RSA\",\"n\":\"wk597GN6pth54yF_Fj04Vk9oUJ4GVOCfJTWac4A_XncmiQxtB6QMj-YVmXY4gf8gjoAZ6-0pz_f4BZWGbzx3EBeUh6o8csUhLlOvDFwHASx-E9Kbfzn3Uj5vng_gYMKX5PCoblAPJAHwk7a9Dd9sdZPYbAEGei78AR_71IzfypWZIMDz2zTYKu6hNqmXMQ8I-8xLf2ZpPzI6L57p3lQbrGn0--WvgGsIxMZrf9JJ9gqlGUPkySpZU0iRLZAHfhCXdcWAAstVTWbVH1biKGNDdJIXKgTxQkJ-09J1-r-r8RfYRRnF8Q8rNqkO_YVsoKJPNRDeKtNbsmOaRkSm2AHGtA7HIogxU_mgxN6fUmn-aUTiwDOxiHHK-2n370cjIMSmY0mrRdEyaP46PtvPaAoEHFBz-WVnNsunaUY-3qDKqWYVBiX_x7FtqBJ7D_Thfjkz51kUKtQa6nYH9xmR85cbrJklJ_wOxeXN1AoR91i735hO8_wnkx2wCyXO05oaJhfogMBFMTdZshi-rXaNV7KAkXNGmVDi1WlHJlfOTScrXY3nIc-WNs-sFIhTN1PVtW3xzcCtWoSKyIZJ6xw-eSuAumoWG_cRPz9DLs99rC42Lm0yoYaP3BAr1X36NBOS8qxhSC5vXT4oeekroYxJE3kDUZMnEH0uaQXBLgqS8ViQcD0\",\"e\":\"AQAB\",\"kid\":\"only\"}]}"},"durationMillis":185}
{"severity":"debug","timestamp":"2022-06-06 19:54:24.031","message":"rq-finalise","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"logging.googleapis.com/trace":"","logging.googleapis.com/spanId":"","logging.googleapis.com/trace_sampled":false,"component":"rq-roundtrip","durationMillis":185}
{"severity":"debug","timestamp":"2022-06-06 19:54:24.032","message":"","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"logging.googleapis.com/trace":"","logging.googleapis.com/spanId":"","logging.googleapis.com/trace_sampled":false,"component":"RequestForgeRockJWT","scopes":"AU.RETAIL.NOMINATION.READ"}
{"severity":"debug","timestamp":"2022-06-06 19:54:24.032","message":"","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"logging.googleapis.com/trace":"","logging.googleapis.com/spanId":"","logging.googleapis.com/trace_sampled":false,"component":"RequestForgeRockJWT","scopes":"AU.RETAIL.CUSTOMERS.BASIC.READ"}
{"severity":"info","timestamp":"2022-06-06 19:54:24.032","message":"rq-begin","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"logging.googleapis.com/trace":"","logging.googleapis.com/spanId":"","logging.googleapis.com/trace_sampled":false,"component":"httpclient","request":{"requestUrl":"http://localhost:8001/system/access_token","curl":"curl -X 'POST' -d 'grant_type=client_credentials&scope=AU.RETAIL.NOMINATION.READ' -H 'Accept: application/vnd.ciam-anz.com+json;version=1.0' -H 'Anz-Application-Id: au-auth' -H 'Anz-Application-Version: 1.0' -H 'Anz-Channel-Function: get-system-token' -H 'Anz-Channel-Id: api-gw' -H 'Authorization: Basic XXXXXX' -H 'Cache-Control: no-cache' -H 'Client-Ip: 192.168.86.142' -H 'Content-Type: application/x-www-form-urlencoded' -H 'Requestid: b9bb04c6-e0ea-41e2-8446-d22b4f742941' -H 'X-Anz-Application-Version: NOT_SET' -H 'X-Application-Context: ob-authorisation-service' -H 'X-Forwarded-For: 192.168.86.142' 'http://localhost:8001/system/access_token'"}}
{"severity":"debug","timestamp":"2022-06-06 19:54:24.033","message":"","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"logging.googleapis.com/trace":"","logging.googleapis.com/spanId":"","logging.googleapis.com/trace_sampled":false,"component":"RequestForgeRockJWT","scopes":"AU.RETAIL.ADR.DETAIL.READ"}
{"severity":"debug","timestamp":"2022-06-06 19:54:24.032","message":"","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"logging.googleapis.com/trace":"","logging.googleapis.com/spanId":"","logging.googleapis.com/trace_sampled":false,"component":"RequestForgeRockJWT","scopes":"AU.RETAIL.NOTIFICATIONS.CREATE AU.RETAIL.ADR.DETAIL.READ"}
{"severity":"info","timestamp":"2022-06-06 19:54:24.033","message":"rq-begin","context":{"service":"authorisation-service","serviceVersion":"NOT_SET"},"logging.googleapis.com/trace":"","logging.googleapis.com/spanId":"","logging.googleapis.com/trace_sampled":false,"component":"httpclient","request":{"requestUrl":"http://localhost:8001/system/access_token","curl":"curl -X 'POST' -d 'grant_type=client_credentials&scope=AU.RETAIL.ADR.DETAIL.READ' -H 'Accept: application/vnd.ciam-anz.com+json;version=1.0' -H 'Anz-Application-Id: au-auth' -H 'Anz-Application-Version: 1.0' -H 'Anz-Channel-Function: get-system-token' -H 'Anz-Channel-Id: api-gw' -H 'Authorization: Basic XXXXXX' -H 'Cache-Control: no-cache' -H 'Client-Ip: 192.168.86.142' -H 'Content-Type: application/x-www-form-urlencoded' -H 'Requestid: d8df30eb-b03e-44d8-bb52-de8157c4a7b7' -H 'X-Anz-Application-Version: NOT_SET' -H 'X-Application-Context: ob-authorisation-service' -H 'X-Forwarded-For: 192.168.86.142' 'http://localhost:8001/system/access_token'"}}